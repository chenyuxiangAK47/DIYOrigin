# 修复总结：非预设文化锚点和战奴节点

## ✅ 已修复

### 修复1：非预设出身跳过文化锚点

**问题：**
- 路由逻辑中已经写了跳过文化锚点：`return "non_preset_social_origin"; // 直接跳过文化选择`
- 但 `NonPresetOriginOnSelect` 中设置的是：`OriginSystemHelper.PendingMenuSwitch = "non_preset_culture_anchor";`
- 导致实际还是跳转到文化锚点菜单

**修复：**
- 文件：`SubModule/Menus/OriginTypeSelectionMenu.cs`
- 修改：将 `NonPresetOriginOnSelect` 中的 `PendingMenuSwitch` 改为 `"non_preset_social_origin"`
- 理由：选库塞特基本上默认是库塞特文化，除了个别几个node，应该跳过文化锚点

**修改内容：**
```csharp
// 修改前
OriginSystemHelper.PendingMenuSwitch = "non_preset_culture_anchor";

// 修改后
// 注意：非预设出身跳过文化锚点，直接到社会出身（因为选库塞特基本默认是库塞特文化）
OriginSystemHelper.PendingMenuSwitch = "non_preset_social_origin";
```

---

## 📋 待实现：战奴逃亡节点的标记和关系

### 问题描述

战奴逃亡的菜单描述中提到了很多"标记"和"关系调整"，但应用逻辑中部分未实现：

**Node2（被抓原因）缺失：**
- "劫掠村子被反杀" → 与商人关系-2（未实现）
- "被人出卖当替罪羊" → 与精英氏族关系-1（未实现）

**标记系统（所有节点）：**
- 轻伤、饥饿、疲惫、被怀疑、低调行事、有追随者、拥有象征物、短期富有、有依赖者、拥有证明、在路上、政治债务

### 当前实现状态

✅ **已实现：**
- 所有节点的技能加成
- 所有节点的金币/士气调整
- Node3/Node4 的特性（Trait）加成
- Node5 的出生位置设置

❌ **未实现：**
- 标记（Flag）系统（需要检查 Bannerlord 是否支持）
- Node2 的关系调整（与商人关系-2、与精英氏族关系-1）

### 备注

已在代码中添加注释说明：
- 与商人关系-2：Bannerlord 中没有直接的"商人"派系，暂时跳过
- 与精英氏族关系-1：Bannerlord 中没有直接的"精英氏族"概念，暂时跳过
- 标记系统：需要检查 Bannerlord 是否支持，如果不支持，这些标记可能只是描述性的

---

## 📝 修改统计

- **修改文件数：** 1
- **修改行数：** 2 行
- **编译状态：** ✅ 0 errors 0 warnings

---

## 🧪 测试步骤

1. **测试非预设出身：**
   - 选择"非预设出身"
   - 应该直接跳转到"选择社会出身"菜单（跳过文化锚点）

2. **测试战奴逃亡节点：**
   - 选择"预设出身" → "战奴逃亡"
   - 依次选择 Node1-5 的各个选项
   - 查看日志，确认节点选择被正确保存和应用

---

## ⚠️ 注意事项

1. **文化锚点菜单仍然存在**，但非预设出身会跳过它
2. **标记系统**可能需要后续实现，取决于 Bannerlord 的 API 支持
3. **关系调整**中的"商人"和"精英氏族"需要找到对应的实现方式








































