# 特性系统实现说明

## 概述

已为库塞特预设出身系统添加了**性格特性（Traits）**功能，根据节点选择动态添加特性，影响角色的性格和未来游戏中的行为。

## 实现的特性类型

Bannerlord中的5种性格特性：
- **Valor（勇敢）**：-2（非常谨慎）到 +2（无畏）
- **Honor（荣誉）**：-2（欺骗）到 +2（荣誉）
- **Mercy（仁慈）**：-2（残忍）到 +2（仁慈）
- **Generosity（慷慨）**：-2（吝啬）到 +2（慷慨）
- **Calculating（算计）**：-2（冲动）到 +2（算计）

## 已实现的特性设置

### 1. 可汗的雇佣战帮 (khans_mercenary)

#### Node1: 你为何被可汗雇佣
- **mercenary_reason_rescue**（救过可汗的人）→ **+Valor（勇敢+1）**
- **mercenary_reason_patron**（背后有商人金主）→ **+Calculating（算计+1）**

#### Node4: 你的底线
- **mercenary_bottomline_loyal**（忠诚-不背叛）→ **+Honor（荣誉+1）**
- **mercenary_bottomline_profit**（利益-随时跳槽）→ **-Honor（荣誉-1）**
- **mercenary_bottomline_ambition**（野心-迟早自立）→ **+Calculating（算计+1）**

### 2. 草原叛酋 (rebel_chief)

#### Node1: 你为何被定为叛酋
- **rebel_reason_raid_caravan**（掠夺商队）→ **-Mercy（仁慈-1）**
- **rebel_reason_protect_tribe**（保护部族）→ **+Valor（勇敢+1）**

### 3. 逃出沙漠的战奴 (slave_escape)

#### Node3: 你是怎么逃出来的
- **slave_escape_revolt**（暴动逃亡）→ **+Valor（勇敢+1）**
- **slave_escape_stealth**（潜行逃亡）→ **+Calculating（算计+1）**
- **slave_escape_organized**（组织逃亡）→ **+Calculating（算计+1）**

#### Node4: 逃跑时你带走了什么
- **slave_loot_sword_head**（奴隶主的人头）→ **+Valor（勇敢+1）**
- **slave_loot_companions**（救走同伴-仁义）→ **+Mercy（仁慈+1）**

### 4. 汗廷军叛逃者 (army_deserter)

#### Node1: 你为何叛逃
- **deserter_reason_massacre**（拒绝屠杀命令）→ **+Mercy（仁慈+1）**
- **deserter_reason_murder**（私斗杀人）→ **-Mercy（仁慈-1）**

#### Node4: 你打算洗白还是彻底当军阀
- **deserter_path_redemption**（洗白-立功求赦）→ **+Honor（荣誉+1）**

### 5. 草原商路守护者 (trade_protector)

#### Node2: 你靠什么吃饭
- **trade_model_smuggling**（灰色走私）→ **-Honor（荣誉-1）**

#### Node4: 你对汗廷的态度
- **trade_attitude_resist**（对抗-绕税口）→ **+Valor（勇敢+1）**

### 6. 西迁部族首领 (migrant_chief)

#### Node4: 你想定居还是继续游牧
- **migrant_goal_revenge**（回草原复仇）→ **+Valor（勇敢+1）**

### 7. 东方旧部复仇者 (old_guard_avenger)

#### Node4: 你如何开局复仇
- **avenger_opening_public**（公开宣言-造势）→ **+Valor（勇敢+1）**

## 技术实现

### AddTrait方法

```csharp
private static void AddTrait(Hero hero, string traitId, int value)
```

**功能**：
- 使用反射获取和设置Hero的特性值
- 特性值范围限制在 -2 到 +2
- 支持所有5种性格特性

**实现方式**：
1. 尝试使用 `Hero.GetTrait()` 和 `Hero.SetTrait()` 方法
2. 如果失败，尝试通过 `Hero.Traits` 字典直接设置
3. 所有操作都有错误处理和日志记录

### 特性ID映射

- `"Valor"` → 勇敢/谨慎
- `"Honor"` → 荣誉/狡猾
- `"Mercy"` → 仁慈/残忍
- `"Generosity"` → 慷慨/吝啬
- `"Calculating"` → 算计/冲动

## 特性影响

特性会影响：
1. **与其他角色的关系**：不同特性的角色会互相影响关系
2. **说服成功率**：某些特性会影响说服选项的成功率
3. **NPC行为**：NPC会根据特性做出不同的选择
4. **任务类型**：某些任务只会提供给特定特性的角色
5. **未来扩展**：为未来的特性加成系统打下基础

## 日志格式

所有特性设置都会输出日志：
```
[OriginSystem] 添加特性: Valor +1 (当前值: 1)
[OriginSystem] 添加特性: Honor -1 (当前值: -1)
```

## 后续扩展建议

1. **更多节点特性**：为更多节点选择添加特性设置
2. **特性加成系统**：根据特性值提供游戏内加成（如勇敢+2时战斗伤害+5%）
3. **特性事件**：根据特性触发特殊事件
4. **特性对话**：根据特性显示不同的对话选项

## 总结

✅ **已完成**：
- 特性系统基础框架
- 11个节点选择的特性设置
- 完整的错误处理和日志记录

🎯 **核心特点**：
- 根据节点选择动态添加特性
- 特性值范围限制在 -2 到 +2
- 支持所有5种性格特性
- 为未来特性加成系统打下基础








































